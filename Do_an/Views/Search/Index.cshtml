@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="input-group w-100 mx-auto d-flex">
    <input id="searchInput" type="search" class="form-control p-3" placeholder="keywords" aria-describedby="search-icon-1">
    <span id="search-icon-1" class="input-group-text p-3"><i class="fa fa-search"></i></span>
    <span id="mic-icon" class="input-group-text p-3">
        <i class="fa fa-microphone" style="cursor: pointer;"></i>
    </span>
</div>

<button id='btnTalk' style="display: none;">Voice chat!</button>
<br>
<br>
<span id='message'></span>

<!-- Khu vực hiển thị danh sách sản phẩm -->
<div id="product-list" class="container-xxl py-5 px-0">
    <div class="row g-0">
        <div class="col-lg-3 col-md-6 product-item" data-name="Sen đá" data-wow-delay="0.1s">
            <div class="row g-0">
                <div class="col-12">
                    <a class="d-block" href="img/gallery-5.jpg" data-lightbox="gallery">
                        <img class="img-fluid" src="~/User/img/gallery-5.jpg" alt="">
                    </a>
                </div>
                <div class="col-12">
                    <a class="d-block" href="img/gallery-1.jpg" data-lightbox="gallery">
                        <img class="img-fluid" src="~/User/img/gallery-1.jpg" alt="">
                    </a>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 product-item" data-name="Cây cảnh" data-wow-delay="0.3s">
            <div class="row g-0">
                <div class="col-12">
                    <a class="d-block" href="img/gallery-2.jpg" data-lightbox="gallery">
                        <img class="img-fluid" src="~/User/img/gallery-2.jpg" alt="">
                    </a>
                </div>
                <div class="col-12">
                    <a class="d-block" href="img/gallery-6.jpg" data-lightbox="gallery">
                        <img class="img-fluid" src="~/User/img/gallery-6.jpg" alt="">
                    </a>
                </div>
            </div>
        </div>
        <!-- Thêm các sản phẩm khác tương tự với `data-name` -->
    </div>
</div>

<script>
    // Phần mã nhận diện giọng nói và các hàm liên quan
    var message = document.querySelector('#message');
    var searchInput = document.querySelector('#searchInput');
    var productList = document.querySelector('#product-list');

    var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
    var SpeechGrammarList = SpeechGrammarList || webkitSpeechGrammarList;

    var grammar = '#JSGF V1.0;';
    var recognition = new SpeechRecognition();
    var speechRecognitionList = new SpeechGrammarList();
    speechRecognitionList.addFromString(grammar, 1);
    recognition.grammars = speechRecognitionList;
    recognition.lang = 'vi-VN';
    recognition.interimResults = false;

    recognition.onresult = function (event) {
        var lastResult = event.results.length - 1;
        var content = event.results[lastResult][0].transcript;
        content = content.replace(/\.$/, '');
        searchInput.value = content;
        performSearch(content); // Thực hiện tìm kiếm sau khi nhận diện giọng nói hoàn tất
    };

    recognition.onspeechend = function () {
        recognition.stop();
    };

    recognition.onerror = function (event) {
        message.textContent = 'Error occurred in recognition: ' + event.error;
    };

    document.querySelector('#mic-icon').addEventListener('click', function () {
        recognition.start();
    });

    // Hàm tìm kiếm và hiển thị sản phẩm phù hợp
    function performSearch(query) {
        console.log("Tìm kiếm với từ khóa: " + query);

        // Lọc các sản phẩm theo từ khóa
        var products = document.querySelectorAll('.product-item');
        products.forEach(function (product) {
            var productName = product.getAttribute('data-name').toLowerCase();
            if (productName.includes(query.toLowerCase())) {
                product.style.display = 'block';  // Hiển thị sản phẩm
            } else {
                product.style.display = 'none';  // Ẩn sản phẩm
            }
        });
    }

    // Thêm sự kiện nhấn phím Enter để thực hiện tìm kiếm
    searchInput.addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
            performSearch(searchInput.value);
        }
    });

    // Thêm sự kiện click cho biểu tượng tìm kiếm
    document.querySelector('#search-icon-1').addEventListener('click', function () {
        performSearch(searchInput.value);
    });
</script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
